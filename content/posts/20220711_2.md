+++ 
draft = true
date = 2022-07-11T09:28:07+09:00
title = "[MYSQL]Illegal mix of collations (utf8_general_ci,IMPLICIT) and (utf8mb4_unicode_ci,COERCIBLE) for operation '='"
description = ""
slug = ""
authors = []
tags = []
categories = ["TroubleShooting","DB"]
externalLink = ""
series = []
+++
# 문제

- 이모지를 포함한 값을 DB에 Insert할 때, Exception 발생

```bash
### Cause: java.sql.SQLException: Illegal mix of collations (utf8_general_ci,IMPLICIT) and (utf8mb4_unicode_ci,COERCIBLE) for operation '='
; uncategorized SQLException; SQL state [HY000]; error code [1267]; Illegal mix of collations (utf8_general_ci,IMPLICIT) and (utf8mb4_unicode_ci,COERCIBLE) for operation '='; nested exception is java.sql.SQLException: Illegal mix of collations (utf8_general_ci,IMPLICIT) and (utf8mb4_unicode_ci,COERCIBLE) for operation '='
```

# 원인

- 테이블의 캐릭터셋이 이모티콘을 지원하지 않아 발생

# 해결

- my.cnf의 캐릭터셋 관련 설정 확인
    
    ```bash
    [mysqld]
    character-set-server=utf8mb4
    collation-server=utf8mb4_unicode_ci
    skip-character-set-client-handshake
    
    [client]
    default-character-set=utf8mb4
    ```
    
- 테이블의 character set 및 collate 변경
    
    ```sql
    alter table `테이블명` modify column `컬럼명` varchar(100) character set utf8mb4 collate utf8mb4_general_ci not null;
    ```
